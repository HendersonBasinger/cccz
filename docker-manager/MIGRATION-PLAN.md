# Workers 到 Docker 管理端功能迁移计划

## 功能对照表

### ✅ 已实现
1. 基础登录/登出
2. 用户CRUD（添加、编辑、删除）
3. 批量操作（启用/禁用/删除）
4. 基础设置保存

### ❌ 待实现

#### 1. 仪表盘功能 (Dashboard)
- [ ] 系统设置开关（11项）
  - 站点名称
  - 开放用户注册
  - 自动审核订单（免费套餐）
  - 新用户注册试用（带天数设置）
  - 注册需要邀请码
  - 订单过期时间设置（待审核/支付）
  - 用户前端快捷链接（2个自定义链接）
  - 自动清理非活跃用户
- [ ] 系统概览统计卡片
- [ ] 数据导出/导入功能

#### 2. 反代 IP 管理 (Proxy IPs)
- [ ] 节点订阅地址配置（支持多个逗号分隔）
- [ ] 官网地址配置
- [ ] 反代 IP 列表（支持拖拽排序）
- [ ] 批量添加 IP
- [ ] 地理位置标识智能选择

#### 3. 优选域名 (Best Domains)
- [ ] 优选域名列表（支持拖拽排序）
- [ ] 批量添加
- [ ] 自动获取 IPv4 优选
- [ ] 自动获取 IPv6 优选
- [ ] 定时任务说明

#### 4. 用户管理增强
- [x] 基础CRUD
- [ ] 订阅复制下拉菜单（8种客户端）
  - 原始订阅
  - Clash
  - SingBox
  - Surge
  - Shadowrocket
  - Quantumult X
  - V2Ray/Xray
  - Surfboard
- [ ] 前端账号关联显示
- [ ] 修改前端密码

#### 5. 公告管理 (Announcements)
- [ ] 公告列表
- [ ] 添加/编辑公告
- [ ] 启用/禁用公告
- [ ] 删除公告
- [ ] 字符计数（500字限制）

#### 6. 套餐管理 (Plans)
- [ ] 套餐列表
- [ ] 添加套餐
- [ ] 编辑套餐
- [ ] 上架/下架
- [ ] 删除套餐
- [ ] 价格设置

#### 7. 订单管理 (Orders)
- [ ] 订单列表（筛选：全部/待审核/已通过/已拒绝/已过期）
- [ ] 批量通过
- [ ] 批量拒绝
- [ ] 单个审核
- [ ] 订单过期倒计时显示

#### 8. 支付通道 (Payment Channels)
- [ ] BEpusdt 对接说明
- [ ] 支付通道列表
- [ ] 添加通道
- [ ] 编辑通道（支持不修改Token）
- [ ] 启用/禁用
- [ ] 删除通道

#### 9. 邀请码管理 (Invites)
- [ ] 邀请码列表
- [ ] 生成邀请码（自动/手动）
- [ ] 使用次数设置
- [ ] 赠送试用天数
- [ ] 备注字段
- [ ] 启用/禁用
- [ ] 编辑邀请码
- [ ] 删除邀请码
- [ ] 复制邀请码

#### 10. 修改密码
- [ ] 管理员密码修改
- [ ] 旧密码验证
- [ ] 新密码确认

## 技术实现要点

### 1. 前端JavaScript函数
需要实现的主要函数：
- `switchSection()` - 切换功能模块
- `loadPlans()` - 加载套餐列表
- `loadOrders()` - 加载订单列表
- `loadAnnouncements()` - 加载公告
- `loadPaymentChannels()` - 加载支付通道
- `loadInviteCodes()` - 加载邀请码
- `updateSystemSettings()` - 更新系统设置
- `fetchBestIPs()` - 获取优选IP
- `exportData()` - 导出数据
- `importData()` - 导入数据

### 2. 侧边栏菜单
10个菜单项：
1. 📊 仪表盘
2. 🌐 反代 IP
3. ⭐ 优选域名
4. 👥 用户管理
5. 📢 公告管理
6. 📦 套餐管理
7. 💳 订单管理
8. 💰 支付通道
9. 🎫 邀请码
10. 🔒 修改密码

### 3. Modal 弹窗
需要的弹窗：
- 编辑用户
- 编辑套餐
- 编辑公告
- 编辑邀请码
- 编辑支付通道

### 4. 移动端适配
- 汉堡菜单按钮
- 侧边栏滑入滑出
- 遮罩层
- 响应式布局

## 实现步骤

1. **第一阶段**：完善HTML结构
   - 添加所有section
   - 添加所有modal
   - 完善样式

2. **第二阶段**：实现JavaScript交互
   - 菜单切换
   - 数据加载
   - CRUD操作

3. **第三阶段**：后端API支持
   - 公告API
   - 套餐API
   - 订单API
   - 支付通道API
   - 邀请码API

4. **第四阶段**：高级功能
   - 拖拽排序
   - 批量操作
   - 数据导入导出
   - 订阅转换

## 文件清单

需要修改的文件：
- `/workspaces/vles/docker-manager/views/admin.js` - 主视图（最重要）
- `/workspaces/vles/docker-manager/routes/admin.js` - 已有大部分API
- `/workspaces/vles/docker-manager/database.js` - 数据库操作（基本完整）
- `/workspaces/vles/docker-manager/server.js` - 路由注册（基本完整）
